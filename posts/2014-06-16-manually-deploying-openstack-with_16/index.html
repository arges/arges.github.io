<!doctype html><html lang><head><link rel=preload href=/chrisarges.net/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/chrisarges.net/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/chrisarges.net/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/chrisarges.net/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script>
<link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>manually deploying openstack with a virtual maas on ubuntu trusty (part 2) |</title><link rel=canonical href=chrisarges.net/posts/2014-06-16-manually-deploying-openstack-with_16/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="manually deploying openstack with a virtual maas on ubuntu trusty (part 2)"><meta property="og:description" content="In the previous post, I went over how to setup a virtual MAAS environment using KVM [1]. Here I will explain how to setup Juju for use with this environment. For this setup, we’ll use the maas-server as the juju client to interact with the cluster.
This guide was very useful:
https://maas.ubuntu.com/docs/juju-quick-start.html
Update to the latest stable tools:
sudo apt-add-repository ppa:juju/stable
sudo apt-get update
Next we want to setup juju on the host machine."><meta property="og:type" content="article"><meta property="og:url" content="chrisarges.net/posts/2014-06-16-manually-deploying-openstack-with_16/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-06-16T10:16:00-07:00"><meta property="article:modified_time" content="2014-06-16T10:16:00-07:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="manually deploying openstack with a virtual maas on ubuntu trusty (part 2)"><meta name=twitter:description content="In the previous post, I went over how to setup a virtual MAAS environment using KVM [1]. Here I will explain how to setup Juju for use with this environment. For this setup, we’ll use the maas-server as the juju client to interact with the cluster.
This guide was very useful:
https://maas.ubuntu.com/docs/juju-quick-start.html
Update to the latest stable tools:
sudo apt-add-repository ppa:juju/stable
sudo apt-get update
Next we want to setup juju on the host machine."><link rel=stylesheet href=/chrisarges.net/css/styles.c05d68261bf086a9d7713c4f8a6215a3601608e267a816a7ee58f139b3d1aae51222aae2081c8e0c6bd35e1334773b7a16283022f31f92afd93bb37e5e822e66.css integrity="sha512-wF1oJhvwhqnXcTxPimIVo2AWCOJnqBan7ljxObPRquUSIqriCByODGvTXhM0dzt6FigwIvMfkq/ZO7N+XoIuZg=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=chrisarges.net/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=chrisarges.net/>Home</a></li><li><a href=chrisarges.net/about>About</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=chrisarges.net/posts/2014-06-13-manually-deploying-openstack-with/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=chrisarges.net/posts/2014-06-25-using-criu-to-checkpoint-kernel-build/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f&text=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f&title=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f&is_video=false&description=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29&body=Check out this article: chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f&title=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f&title=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f&name=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29&description=In%20the%20previous%20post%2c%20I%20went%20over%20how%20to%20setup%20a%20virtual%20MAAS%20environment%20using%20KVM%20%5b1%5d.%20Here%20I%20will%20explain%20how%20to%20setup%20Juju%20for%20use%20with%20this%20environment.%20For%20this%20setup%2c%20we%e2%80%99ll%20use%20the%20maas-server%20as%20the%20juju%20client%20to%20interact%20with%20the%20cluster.%0aThis%20guide%20was%20very%20useful%3a%0ahttps%3a%2f%2fmaas.ubuntu.com%2fdocs%2fjuju-quick-start.html%0aUpdate%20to%20the%20latest%20stable%20tools%3a%0asudo%20apt-add-repository%20ppa%3ajuju%2fstable%0asudo%20apt-get%20update%0aNext%20we%20want%20to%20setup%20juju%20on%20the%20host%20machine." aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f&t=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">manually deploying openstack with a virtual maas on ubuntu trusty (part 2)</h1><div class=meta><div class=postdate><time datetime="2014-06-16 10:16:00.001 -0700 -0700" itemprop=datePublished>2014-06-16</time></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/openstack rel=tag>openstack</a>
,
<a class=tag-link href=/tags/juju rel=tag>juju</a>
,
<a class=tag-link href=/tags/maas rel=tag>maas</a>
,
<a class=tag-link href=/tags/ubuntu rel=tag>ubuntu</a></div></div></header><div id=toc></div><div class=content itemprop=articleBody>In the previous post, I went over how to setup a virtual MAAS environment using KVM [<a href=http://dinosaursareforever.blogspot.com/2014/06/manually-deploying-openstack-with.html>1</a>]. Here I will explain how to setup Juju for use with this environment.<br><br>For this setup, we’ll use the maas-server as the juju client to interact with the cluster.<br><br>This guide was very useful:<br><a href=https://maas.ubuntu.com/docs/juju-quick-start.html>https://maas.ubuntu.com/docs/juju-quick-start.html</a><br><br>Update to the latest stable tools:<br><pre class=prettyprint>sudo apt-add-repository ppa:juju/stable<br>sudo apt-get update<br></pre>Next we want to setup juju on the host machine.<br><pre class=prettyprint>sudo apt-get install juju-core</pre>Create juju environment file.<br><pre class=prettyprint>juju init</pre>Generate a specific MAAS API key by using the following link:<br><a href=http://192.168.100.10/MAAS/account/prefs/>http://192.168.100.10/MAAS/account/prefs/</a><br><br>write the following to ~/.juju/environments.yaml replacing ‘maas api key’ with what was generated above:<br><pre class=prettyprint>default: vmaas<br>environments:<br>&nbsp; vmaas:<br>&nbsp; &nbsp; type: maas<br>&nbsp; &nbsp; maas-server: 'http://192.168.100.10/MAAS'<br>&nbsp; &nbsp; maas-oauth: '&lt;maas api key&gt;'<br>&nbsp; &nbsp; admin-secret: ubuntu # or something generated with uuid<br>&nbsp; &nbsp; default-series: trusty<br></pre>Now let’s sync tools and bootstrap a node. Note, if you have multiple juju environments then you may need to specify ‘-e vmaas’ if it isn’t your default environment.<br><pre class=prettyprint>juju sync-tools<br>juju bootstrap # add --show-log --debug &nbsp;for more output<br></pre>See if it works by using the following command:<br><pre class=prettyprint>juju status</pre>You should see something similar to the following:<br><pre class=prettyprint>~$ juju status<br>environment: vmaas<br>machines:<br>&nbsp; "0":<br>&nbsp; &nbsp; agent-state: down<br>&nbsp; &nbsp; agent-state-info: (started)<br>&nbsp; &nbsp; agent-version: 1.18.4<br>&nbsp; &nbsp; dns-name: maas-node-0.maas<br>&nbsp; &nbsp; instance-id: /MAAS/api/1.0/nodes/node-e41b0c34-e1cb-11e3-98c6-5254001aae69/<br>&nbsp; &nbsp; series: trusty<br>services: {}<br></pre>Now we can do a test deployment with the juju-gui to our bootstrap node.<br><pre class=prettyprint>juju deploy juju-gui</pre>While it is deploying you can type the following to get a log.<br><pre class=prettyprint>juju debug-log</pre>I wanted to be able to access the juju-gui from an ‘external’ address, so I edited /etc/networking/interfaces on that machine to have a static address:<br><pre class=prettyprint>juju ssh 0</pre><pre class=prettyprint>sudo vim /etc/networking/interfaces<br></pre>Add the following to the file:<br><pre class=prettyprint>auto eth0<br>iface eth0 inet static<br>&nbsp; address 192.168.100.11<br>&nbsp; netmask 255.255.255.0<br></pre>Bring that interface up.<br><pre class=prettyprint>sudo ifup eth0</pre>The password can be found here on the host machine:<br><pre class=prettyprint>grep pass .juju/environments/vmaas.jenv</pre>If you used the above configurations it should be ‘ubuntu’.<br><br>Log into the service so you can monitor the status graphically during the deployment.<br><br>If you get errors saying that servers couldn’t be reached you may have DNS configuration or proxy issues. You’ll have to first resolve these before using Juju. I’ve had is intermittent network issues in my lab. In order to workaround those physical issues you may have to retry the bootstrap, or increase the timeout values in ~/.juju/environments.yaml to use the following:<br><pre class=prettyprint>&nbsp; bootstrap-retry-delay: 5<br>&nbsp; bootstrap-timeout: 1200<br></pre>Now you’re cooking with juju.<br><ol><li><a href=http://dinosaursareforever.blogspot.com/2014/06/manually-deploying-openstack-with.html>http://dinosaursareforever.blogspot.com/2014/06/manually-deploying-openstack-with.html</a></li></ol></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=chrisarges.net/>Home</a></li><li><a href=chrisarges.net/about>About</a></li></ul></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f&text=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f&title=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f&is_video=false&description=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29&body=Check out this article: chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f&title=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f&title=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f&name=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29&description=In%20the%20previous%20post%2c%20I%20went%20over%20how%20to%20setup%20a%20virtual%20MAAS%20environment%20using%20KVM%20%5b1%5d.%20Here%20I%20will%20explain%20how%20to%20setup%20Juju%20for%20use%20with%20this%20environment.%20For%20this%20setup%2c%20we%e2%80%99ll%20use%20the%20maas-server%20as%20the%20juju%20client%20to%20interact%20with%20the%20cluster.%0aThis%20guide%20was%20very%20useful%3a%0ahttps%3a%2f%2fmaas.ubuntu.com%2fdocs%2fjuju-quick-start.html%0aUpdate%20to%20the%20latest%20stable%20tools%3a%0asudo%20apt-add-repository%20ppa%3ajuju%2fstable%0asudo%20apt-get%20update%0aNext%20we%20want%20to%20setup%20juju%20on%20the%20host%20machine." aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=chrisarges.net%2fposts%2f2014-06-16-manually-deploying-openstack-with_16%2f&t=manually%20deploying%20openstack%20with%20a%20virtual%20maas%20on%20ubuntu%20trusty%20%28part%202%29" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2023 Chris J Arges</div><div class=footer-right><nav><ul><li><a href=chrisarges.net/>Home</a></li><li><a href=chrisarges.net/about>About</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/chrisarges.net/js/code-copy.js></script></html>