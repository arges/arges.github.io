<!doctype html><html lang><head><link rel=preload href=/chrisarges.net/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/chrisarges.net/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/chrisarges.net/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/chrisarges.net/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script>
<link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>setting up a Minecraft server |</title><link rel=canonical href=chrisarges.net/posts/2020-09-04-setting-up-a-minecraft-server/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="setting up a Minecraft server"><meta property="og:description" content="We&rsquo;ve been spending a lot of time at home lately due to the current pandemic. Because of this the kids have really enjoyed playing Minecraft together. Initially I set up a LAN server for them to play together, but wanted to set up a community server that their friends could also access. Here I&rsquo;ll describe some approaches to this with the goal of keeping things automated, low cost, secure and easy for friends to play."><meta property="og:type" content="article"><meta property="og:url" content="chrisarges.net/posts/2020-09-04-setting-up-a-minecraft-server/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-09-04T10:22:46-05:00"><meta property="article:modified_time" content="2020-09-04T10:22:46-05:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="setting up a Minecraft server"><meta name=twitter:description content="We&rsquo;ve been spending a lot of time at home lately due to the current pandemic. Because of this the kids have really enjoyed playing Minecraft together. Initially I set up a LAN server for them to play together, but wanted to set up a community server that their friends could also access. Here I&rsquo;ll describe some approaches to this with the goal of keeping things automated, low cost, secure and easy for friends to play."><link rel=stylesheet href=/chrisarges.net/css/styles.c05d68261bf086a9d7713c4f8a6215a3601608e267a816a7ee58f139b3d1aae51222aae2081c8e0c6bd35e1334773b7a16283022f31f92afd93bb37e5e822e66.css integrity="sha512-wF1oJhvwhqnXcTxPimIVo2AWCOJnqBan7ljxObPRquUSIqriCByODGvTXhM0dzt6FigwIvMfkq/ZO7N+XoIuZg=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=chrisarges.net/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=chrisarges.net/>Home</a></li><li><a href=chrisarges.net/about>About</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=chrisarges.net/posts/2019-07-16-openssh-install-on-windows/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=chrisarges.net/posts/2020-12-11-tracing-on-linux/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f&text=setting%20up%20a%20Minecraft%20server" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f&title=setting%20up%20a%20Minecraft%20server" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f&is_video=false&description=setting%20up%20a%20Minecraft%20server" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=setting%20up%20a%20Minecraft%20server&body=Check out this article: chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f&title=setting%20up%20a%20Minecraft%20server" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f&title=setting%20up%20a%20Minecraft%20server" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f&name=setting%20up%20a%20Minecraft%20server&description=We%26rsquo%3bve%20been%20spending%20a%20lot%20of%20time%20at%20home%20lately%20due%20to%20the%20current%20pandemic.%20Because%20of%20this%20the%20kids%20have%20really%20enjoyed%20playing%20Minecraft%20together.%20Initially%20I%20set%20up%20a%20LAN%20server%20for%20them%20to%20play%20together%2c%20but%20wanted%20to%20set%20up%20a%20community%20server%20that%20their%20friends%20could%20also%20access.%20Here%20I%26rsquo%3bll%20describe%20some%20approaches%20to%20this%20with%20the%20goal%20of%20keeping%20things%20automated%2c%20low%20cost%2c%20secure%20and%20easy%20for%20friends%20to%20play." aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f&t=setting%20up%20a%20Minecraft%20server" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">setting up a Minecraft server</h1><div class=meta><div class=postdate><time datetime="2020-09-04 10:22:46 -0500 -0500" itemprop=datePublished>2020-09-04</time></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/linux rel=tag>linux</a>
,
<a class=tag-link href=/tags/parenting rel=tag>parenting</a></div></div></header><div id=toc><nav id=TableOfContents></nav></div><div class=content itemprop=articleBody><p>We&rsquo;ve been spending a lot of time at home lately due to the current pandemic.
Because of this the kids have really enjoyed playing Minecraft together.
Initially I set up a LAN server for them to play together, but wanted to set up
a community server that their friends could also access. Here I&rsquo;ll describe
some approaches to this with the goal of keeping things automated, low cost,
secure and easy for friends to play.</p><p>I&rsquo;ll be only talking about setting up a Minecraft server that works with the
&lsquo;Java Edition&rsquo; of Minecraft since it is possible to deploy on your own. This
becomes a source of confusion for many friend&rsquo;s parents as they may have
installed the myriad of other editions that exist.</p><p>This is a fun write-up because it really is a mini exercise in deploying a
service and having &lsquo;customers&rsquo;. I&rsquo;ll go through hosting options, deployment,
managing the application, monitoring and various other things I encountered
along the way.</p><h1 id=specifications>Specifications</h1><p>Ideally we&rsquo;ll be hosting about 10 player max, so we don&rsquo;t need a ton of
CPU/Memory. In addition we&rsquo;ll want to be able to do backups periodically in
case there are crashes. In practice I&rsquo;ve been getting away with a 2 vCPU
machine with 8GB of ram with proper JVM tuning flags. It seems that the
Minecraft server is very CPU intensive and needs faster clock speeds rather
than more parallel threads.</p><h1 id=hosting>Hosting</h1><p>One could choose a first-tier public cloud such as AWS, GCP, or Azure. Another
option would be using a VPS and paying monthly. This is such an open ended
question and really dictates your cost. I chose GCP because they give free
credit, I had never really used the service, and they had a pretty good write
up on how to run Minecraft on GCP.</p><h1 id=deployment>Deployment</h1><p>Here are a few write-ups on how to deploy Minecraft on GCP. This is where I
started to figure out what was needed.</p><ul><li><a href=https://cloud.google.com/solutions/gaming/Minecraft-server>https://cloud.google.com/solutions/gaming/Minecraft-server</a></li><li><a href=https://cloud.google.com/blog/products/gcp/brick-by-brick-learn-gcp-by-setting-up-a-Minecraft-server>https://cloud.google.com/blog/products/gcp/brick-by-brick-learn-gcp-by-setting-up-a-Minecraft-server</a></li><li><a href=https://medium.com/@jtlimson/deploy-Minecraft-server-in-gcp-d3536e2e1d82>https://medium.com/@jtlimson/deploy-Minecraft-server-in-gcp-d3536e2e1d82</a></li></ul><p>Instead of duplicating the above articles, I was able to follow these mostly
to get things setup. Below I&rsquo;ll go over how I made operations a bit smoother.</p><h1 id=operation>Operation</h1><p>After using the above write-ups to get into working state, operating this
service requires a bit more tuning and attention. For example just running
Minecraft in a screen session doesn&rsquo;t really help if things crash. The first
thing I did was to make a systemd service to run my service. The first version
was a little rough since it was grafted on top of the original example:</p><pre tabindex=0><code>[Unit]
Description=Minecraft Server
After=network.target

[Service]
Type=simple
RestartSec=5
WorkingDirectory=/home/user

User=user

Restart=always
ExecStart=/usr/bin/screen -L -D -m -S mcs java -Xms1G -XX:+UseConcMarkSweepGC -XX:ParallelGCThreads=2 -XX:+AggressiveOpts -Xmx7G -jar /home/user/server.jar nogui

[Install]
WantedBy=multi-user.target
</code></pre><p>With the above service running, if there was a crash the server would be
relaunched. In addition, I was able to attach to the screen session and issue
commands as needed.</p><h1 id=backups>Backups</h1><p>In addition I added a backup script that would be run by a cronjob:</p><pre tabindex=0><code>#!/bin/bash -x
/snap/bin/gsutil cp -R /home/user/world gs://somename-Minecraft-backup/$(date &#34;+%Y%m%d-%H%M%S&#34;)-world
</code></pre><h1 id=tuning>Tuning</h1><p>With these settings things were mostly stable, if there were crashes the
service would restart. However I would very frequently see the message:</p><pre tabindex=0><code>[16:23:42] [Server thread/WARN]: Can&#39;t keep up! Is the server overloaded? Running 12503ms or 250 ticks behind
[16:24:08] [Server thread/WARN]: Can&#39;t keep up! Is the server overloaded? Running 10362ms or 207 ticks behind
</code></pre><p>This is an indication your CPU is a bit underpowered. So scaling up your CPU
would help here. In addition the server may actually terminate if it gets too
overloaded. So I had to change the following setting in <code>server.properties</code> to
get this working:</p><pre tabindex=0><code>max-tick-time=-1
</code></pre><h1 id=security>Security</h1><p>I wanted my Minecraft server to be &lsquo;invite-only&rsquo; so that only users I knew
could access the service. The only mechanism I found for this with Minecraft
server would be to &lsquo;white-list&rsquo; access to specific user names.</p><p>Ensure you set the following in server.properties:</p><pre tabindex=0><code>white-list=true
</code></pre><p>Now you must manually white-list new players that join the game. You can do
this by adding names in the <code>whitelist.json</code> file,
or by using <code>/whitelist add &lt;username></code> in the Minecraft console.</p><p>Finally ensuring that automatic updates are performed is critical:</p><pre tabindex=0><code>sudo apt install unattended-upgrades
# edit /etc/apt/apt.conf.d/50unattended-upgrades with proper settings
</code></pre><h1 id=conclusion>Conclusion</h1><p>At this point the only other things is having fun and reducing costs. Overall
this has been a hit and something that&rsquo;s provided a lot of fun for my kids.</p></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=chrisarges.net/>Home</a></li><li><a href=chrisarges.net/about>About</a></li></ul></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f&text=setting%20up%20a%20Minecraft%20server" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f&title=setting%20up%20a%20Minecraft%20server" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f&is_video=false&description=setting%20up%20a%20Minecraft%20server" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=setting%20up%20a%20Minecraft%20server&body=Check out this article: chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f&title=setting%20up%20a%20Minecraft%20server" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f&title=setting%20up%20a%20Minecraft%20server" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f&name=setting%20up%20a%20Minecraft%20server&description=We%26rsquo%3bve%20been%20spending%20a%20lot%20of%20time%20at%20home%20lately%20due%20to%20the%20current%20pandemic.%20Because%20of%20this%20the%20kids%20have%20really%20enjoyed%20playing%20Minecraft%20together.%20Initially%20I%20set%20up%20a%20LAN%20server%20for%20them%20to%20play%20together%2c%20but%20wanted%20to%20set%20up%20a%20community%20server%20that%20their%20friends%20could%20also%20access.%20Here%20I%26rsquo%3bll%20describe%20some%20approaches%20to%20this%20with%20the%20goal%20of%20keeping%20things%20automated%2c%20low%20cost%2c%20secure%20and%20easy%20for%20friends%20to%20play." aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=chrisarges.net%2fposts%2f2020-09-04-setting-up-a-minecraft-server%2f&t=setting%20up%20a%20Minecraft%20server" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2023 Chris J Arges</div><div class=footer-right><nav><ul><li><a href=chrisarges.net/>Home</a></li><li><a href=chrisarges.net/about>About</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/chrisarges.net/js/code-copy.js></script></html>